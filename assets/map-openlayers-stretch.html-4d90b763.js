import{_ as e,r as p,o as t,c as o,f as c,a as n,b as a,d as i,e as l}from"./app-2c72f79b.js";const r={},u=n("h1",{id:"解决-openlayers-初始化地图贴片被拉伸问题",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#解决-openlayers-初始化地图贴片被拉伸问题","aria-hidden":"true"},"#"),a(" 解决 OpenLayers 初始化地图贴片被拉伸问题")],-1),d=n("p",null,[a("OpenLayers 地图加载高德地图数据的时候，在初始化的时候地图贴片被拉伸，"),n("br"),a(" 下图可以很明显的看到底图被拉伸了，可以配合高德加载的块图片比较下。")],-1),k={href:"http://wprd01.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=7&x=1711&y=831&z=11",target:"_blank",rel:"noopener noreferrer"},m=l(`<figure><img src="https://image.liubing.me/2019/12/26/28de90461c4b2.png" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><figure><img src="https://image.liubing.me/2019/12/26/2fdf854263f84.png" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>下图为调整窗口后自动更新了地图的底图尺寸，变成正常的，可以和上面的比较下</p><figure><img src="https://image.liubing.me/2019/12/26/75a33c6ec1c83.png" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><p>初始化的时候底图被拉伸变形，导致绘图的点的位置不正确，如下面的动图所示。</p><figure><img src="https://image.liubing.me/2019/12/26/8aacb6511c13b.gif" alt="1566195584967-5cda7db7-a0e8-427f-8686-3e291f92fdf1" tabindex="0" loading="lazy"><figcaption>1566195584967-5cda7db7-a0e8-427f-8686-3e291f92fdf1</figcaption></figure><h2 id="解决方法" tabindex="-1"><a class="header-anchor" href="#解决方法" aria-hidden="true">#</a> 解决方法</h2><p>通过查阅文档，得知<code>Map</code>下面有个<code>updateSize</code>方法用于强制重新计算地图大小<br> 所以在地图初始化的可以异步调用下这个方法即可：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>GDMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&#39;GDMap&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">layers</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">TileLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">XYZ</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;http://wprd0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;style=7&amp;x={x}&amp;y={y}&amp;z={z}&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>vector
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">view</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">View</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">projection</span><span class="token operator">:</span> <span class="token string">&#39;EPSG:4326&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.864608</span><span class="token punctuation">,</span> <span class="token number">32.016212</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
    <span class="token literal-property property">minZoom</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token literal-property property">maxZoom</span><span class="token operator">:</span> <span class="token number">20</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>GDMap<span class="token punctuation">.</span><span class="token function">updateSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9);function v(g,b){const s=p("ExternalLinkIcon");return t(),o("div",null,[u,d,c(" more "),n("p",null,[n("a",k,[a("http://wprd01.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=7&x=1711&y=831&z=11"),i(s)])]),m])}const f=e(r,[["render",v],["__file","map-openlayers-stretch.html.vue"]]);export{f as default};
